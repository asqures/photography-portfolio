<!DOCTYPE html>
<html lang="en" class="scroll-smooth">

<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Jordan T. Prodanoff - Portfolio</title>
  <meta name="description"
    content="Hi there!">
  <!-- Favicon -->
  <link rel="icon" type="image/x-icon" href="dist/assets/favicon.ico" />
  <link rel="stylesheet" href="dist/output.css" />
  <link rel="stylesheet" href="styles.css" />
  <!-- Alpine.js -->
  <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
  <!-- Start - Fonts -->
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link href="https://fonts.googleapis.com/css2?family=Signika:wght@400;700&display=swap" rel="stylesheet">
  <!-- End - Fonts -->
  <!-- Start - Fancybox Scripts -->
  <script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0/dist/fancybox/fancybox.umd.js"></script>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0/dist/fancybox/fancybox.css" />
  <script src="https://code.jquery.com/jquery-3.6.3.min.js"
    integrity="sha256-pvPw+upLPUjgMXY0G+8O0xUf+/Im1MZjXxxgOcBQBXU=" crossorigin="anonymous"></script>
  <!-- Justified‑Gallery CSS -->
  <link  href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.9.1/dist/css/justifiedGallery.min.css" rel="stylesheet"/>
  <!-- Justified‑Gallery JS -->
  <script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.9.1/dist/js/jquery.justifiedGallery.min.js"></script>
  <!-- Masonry -->
  <script src="https://unpkg.com/masonry-layout@4/dist/masonry.pkgd.min.js"></script>
  <script src="https://unpkg.com/imagesloaded@5/imagesloaded.pkgd.min.js"></script>
  <!-- End - Fancybox Scripts -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      content: ["./dist/*.{html,js}"],
      theme: {
        extend:
                {
                  fontFamily: {
                    'nothingyoucoulddo': ['Nothing You Could Do', 'cursive'],
                    'signika': ['Signika', 'sans-serif'],
                  },
                },
      },
      plugins: [],
    }
  </script>
  <script src="https://identity.netlify.com/v1/netlify-identity-widget.js"></script>
    
 <style>
    /* Container spans full width */
    #gallery {
      width: 100%;
      box-sizing: border-box;
    }
    /* Each row is its own flex‑box with a bottom gutter */
    #gallery .row {
      display: flex;
      margin-bottom: 16px;   /* vertical gutter */
    }
    /* Each item is a block; we’ll add right‑margins manually in JS */
    #gallery .row a {
      display: block;
    }
  </style>
    
</head>

<body
  class="dark:bg-black bg-white h-screen text-black dark:text-white px-5 md:px-20 opacity-0 animate-fade-in transition duration-500">
  <!-- Navbar -->
  <header class="flex w-full overflow-hidden pt-10 pb-1">
    <!-- Navbar -->
    <nav id="nav" x-data="{ open: false }" role="navigation" class="w-full">
      <div class="container mx-auto flex flex-wrap items-center md:flex-no-wrap">
        <div class="mr-4 md:mr-8">
          <a href="index.html" class="text-2xl font-signika font-bold">JORDAN T. PRODANOFF</a>
        </div>
        <div class="ml-auto md:hidden flex items-center justify-start">
          <button onclick="menuToggle()" @click="open = !open"
            class="tap-highlight-transparent text-black dark:text-white w-5 h-5 relative focus:outline-none"
            @click="open = !open">
            <span class="sr-only">Open main menu</span>
            <div class="block w-5 absolute left-1/2 top-1/2 transform -translate-x-1/2 -translate-y-1/2">
              <span aria-hidden="true"
                class="block absolute h-0.5 w-5 bg-current transform transition duration-500 ease-in-out"
                :class="{'rotate-45': open,' -translate-y-1.5': !open }"></span>
              <span aria-hidden="true"
                class="block absolute  h-0.5 w-5 bg-current   transform transition duration-500 ease-in-out"
                :class="{'opacity-0': open } "></span>
              <span aria-hidden="true"
                class="block absolute h-0.5 w-5 bg-current transform  transition duration-500 ease-in-out"
                :class="{'-rotate-45': open, ' translate-y-1.5': !open}"></span>
            </div>
          </button>
        </div>
        <div id="menu"
          class="w-full h-0 transition-all ease-out duration-500 md:transition-none md:w-auto md:flex-grow md:flex md:items-center">
          <ul id="ulMenu"
            class="flex flex-col duration-300 ease-out md:space-x-5 sm:transition-none mt-5 md:flex-row md:items-center md:ml-auto md:mt-0 md:pt-0 md:border-0">
            <li class="group transition duration-300">
              <a href="index.html" class="font-signika text-2xl tap-highlight-transparent">PORTFOLIO
                <span class="hidden md:block h-0.5 bg-black dark:bg-white"></span>
              </a>
            </li>
            <li class="group transition duration-300">
              <a href="dist/about_me.html" class="font-signika text-2xl tap-highlight-transparent">ABOUT ME
                <span
                  class="hidden md:block max-w-0 group-hover:max-w-full transition-all duration-500 h-0.5 bg-black dark:bg-white"></span>
              </a>
            </li>
            <li class="group transition duration-300">
              <a href="dist/contact.html" class="font-signika text-2xl tap-highlight-transparent">CONTACT
                <span
                  class="hidden md:block max-w-0 group-hover:max-w-full transition-all duration-500 h-0.5 bg-black dark:bg-white"></span>
              </a>
            </li>
          </ul>
        </div>
      </div>
    </nav>
  </header>
  <!-- Content -->

<!-- wherever you want the gallery -->
<!-- gallery placeholder -->
<section id="gallery" class="mt-12"></section>

<!-- imagesLoaded dependency -->
<script src="https://unpkg.com/imagesloaded@5/imagesloaded.pkgd.min.js"></script>

<!-- your gallery script with debug log -->
<!-- right after <section id="gallery"></section> -->
<!-- imagesLoaded is no longer used, so you can remove its <script> tag if you like -->

<script>
(async function(){
  const GUTTER  = 16;                       // px between images
  const gallery = document.getElementById('gallery');
  console.log('[DEBUG] gallery init →', gallery);

  // 1) Fetch and preload all images
  let imgElems;
  try {
    const res = await fetch('gallery.json');
    if (!res.ok) throw new Error(`gallery.json HTTP ${res.status}`);
    const { images } = await res.json();
    console.log('[DEBUG] JSON images.length =', images.length);

    imgElems = await Promise.all(images.map(({src,alt}, i) => new Promise((res,rej) => {
      const img = new Image();
      img.src = src; img.alt = alt||'';
      img.onload  = () => { console.log(`[DEBUG] preloaded #${i}`); res(img); };
      img.onerror = () => rej(new Error(`Failed to load image ${src}`));
    })));
  } catch(err) {
    console.error('[ERROR] preload:', err);
    gallery.innerHTML = `<p style="color:red;">${err.message}</p>`;
    return;
  }

  // 2) Core layout
  function buildRows() {
    console.log('[DEBUG] buildRows start; total images =', imgElems.length);
    gallery.innerHTML = '';
    const cw = gallery.clientWidth;
    let i = 0;

    while (i < imgElems.length) {
      // peek at the next up to 3 imgs
      const upcoming = imgElems.slice(i, i + 3);
      const flags    = upcoming.map(img => img.naturalWidth > img.naturalHeight ? 'L' : 'P');
      console.log(`[DEBUG] upcoming [${i}→${i+upcoming.length-1}] flags=`, flags);

      let chunkLen;
      if (upcoming.length < 3) {
        // if only 1 left, take it; if 2 and first is landscape, pair them; otherwise take what's left
        chunkLen = (upcoming.length === 2 && flags[0] === 'L') ? 2 : upcoming.length;
      } else {
        // 3 available: if any of the three is landscape, force a pair
        const hasLandscape = flags.includes('L');
        chunkLen = hasLandscape ? 2 : 3;
      }
      console.log('[DEBUG] chunkLen =', chunkLen);

      const chunk = imgElems.slice(i, i + chunkLen);
      i += chunkLen;
      sizeRow(chunk, cw);
    }
  }

  // 3) Size & append a row of imgs
  function sizeRow(imgs, rowWidth) {
    const ratios = imgs.map(img => img.naturalWidth / img.naturalHeight);
    const totalR = ratios.reduce((a,b) => a + b, 0);
    const H      = (rowWidth - GUTTER * (imgs.length - 1)) / totalR;

    const rowDiv = document.createElement('div');
    rowDiv.className = 'row';
    rowDiv.style.marginBottom = GUTTER + 'px';
    gallery.appendChild(rowDiv);

    let used = 0;
    ratios.forEach((r, idx) => {
      let W = Math.floor(r * H);
      if (idx === imgs.length - 1) {
        W = rowWidth - used - GUTTER * (imgs.length - 1);
      }
      used += W;

      const img = imgs[idx];
      img.style.width  = W + 'px';
      img.style.height = H + 'px';

      const a = document.createElement('a');
      a.href = img.src;
      a.dataset.fancybox = 'gallery';
      a.appendChild(img);
      if (idx < imgs.length - 1) a.style.marginRight = GUTTER + 'px';
      rowDiv.appendChild(a);
    });
  }

  // Initial render + reflow on resize
  buildRows();
  window.addEventListener('resize', buildRows);

  console.log('[DEBUG] gallery built');
})();
</script>


<!-- ✂─────────────────────────────────────────────✂ -->
  
  <!-- Footer -->
  <footer>
    <div class="max-w-screen-xl py-16 mx-auto">
      <div class="grid grid-cols-1 gap-8 text-center mx-auto">
        <div>
          <p class="font-signika"><b>JORDAN T. PRODANOFF</b></p>
          <p class="mt-4 text-sm text-gray-600 dark:text-gray-300">
            <!-- address -->
          </p>
        </div>
      </div>
    </div>
  </footer>
  <!-- Script for the LightBox -->
  <script>
    Fancybox.bind("[data-fancybox]", {});
  </script>
  <script src="dist/fade_in.js"></script>
  <script src="dist/menu.js"></script>
</body>

</html>
